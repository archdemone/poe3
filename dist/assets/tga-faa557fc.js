import{L as R}from"./main-cbd8a0ec.js";const U=1,A=2,N=3,d=9,Y=10,k=11,L=48,O=4,z=0,P=1,B=2,H=3;function T(o){let r=0;return{id_length:o[r++],colormap_type:o[r++],image_type:o[r++],colormap_index:o[r++]|o[r++]<<8,colormap_length:o[r++]|o[r++]<<8,colormap_size:o[r++],origin:[o[r++]|o[r++]<<8,o[r++]|o[r++]<<8],width:o[r++]|o[r++]<<8,height:o[r++]|o[r++]<<8,pixel_size:o[r++],flags:o[r++]}}function S(o,r){if(r.length<19){R.Error("Unable to load TGA file - Not enough data to contain header");return}let l=18;const a=T(r);if(a.id_length+l>r.length){R.Error("Unable to load TGA file - Not enough data");return}l+=a.id_length;let m=!1,u=!1,x=!1;switch(a.image_type){case d:m=!0;case U:u=!0;break;case Y:m=!0;case A:break;case k:m=!0;case N:x=!0;break}let f;const _=a.pixel_size>>3,c=a.width*a.height*_;let n;if(u&&(n=r.subarray(l,l+=a.colormap_length*(a.colormap_size>>3))),m){f=new Uint8Array(c);let D,y,p,I=0;const E=new Uint8Array(_);for(;l<c&&I<c;)if(D=r[l++],y=(D&127)+1,D&128){for(p=0;p<_;++p)E[p]=r[l++];for(p=0;p<y;++p)f.set(E,I+p*_);I+=_*y}else{for(y*=_,p=0;p<y;++p)f[I+p]=r[l++];I+=y}}else f=r.subarray(l,l+=u?a.width*a.height:c);let h,s,i,t,e,g;switch((a.flags&L)>>O){default:case B:h=0,i=1,g=a.width,s=0,t=1,e=a.height;break;case z:h=0,i=1,g=a.width,s=a.height-1,t=-1,e=-1;break;case H:h=a.width-1,i=-1,g=-1,s=0,t=1,e=a.height;break;case P:h=a.width-1,i=-1,g=-1,s=a.height-1,t=-1,e=-1;break}const w="_getImageData"+(x?"Grey":"")+a.pixel_size+"bits",G=q[w](a,n,f,s,t,e,h,i,g);o.getEngine()._uploadDataToTextureDirectly(o,G)}function X(o,r,l,a,m,u,x,f,_){const c=l,n=r,h=o.width,s=o.height;let i,t=0,e,g;const w=new Uint8Array(h*s*4);for(g=a;g!==u;g+=m)for(e=x;e!==_;e+=f,t++)i=c[t],w[(e+h*g)*4+3]=255,w[(e+h*g)*4+2]=n[i*3+0],w[(e+h*g)*4+1]=n[i*3+1],w[(e+h*g)*4+0]=n[i*3+2];return w}function C(o,r,l,a,m,u,x,f,_){const c=l,n=o.width,h=o.height;let s,i=0,t,e;const g=new Uint8Array(n*h*4);for(e=a;e!==u;e+=m)for(t=x;t!==_;t+=f,i+=2){s=c[i+0]+(c[i+1]<<8);const w=((s&31744)>>10)*255/31|0,G=((s&992)>>5)*255/31|0,b=(s&31)*255/31|0;g[(t+n*e)*4+0]=w,g[(t+n*e)*4+1]=G,g[(t+n*e)*4+2]=b,g[(t+n*e)*4+3]=s&32768?0:255}return g}function F(o,r,l,a,m,u,x,f,_){const c=l,n=o.width,h=o.height;let s=0,i,t;const e=new Uint8Array(n*h*4);for(t=a;t!==u;t+=m)for(i=x;i!==_;i+=f,s+=3)e[(i+n*t)*4+3]=255,e[(i+n*t)*4+2]=c[s+0],e[(i+n*t)*4+1]=c[s+1],e[(i+n*t)*4+0]=c[s+2];return e}function K(o,r,l,a,m,u,x,f,_){const c=l,n=o.width,h=o.height;let s=0,i,t;const e=new Uint8Array(n*h*4);for(t=a;t!==u;t+=m)for(i=x;i!==_;i+=f,s+=4)e[(i+n*t)*4+2]=c[s+0],e[(i+n*t)*4+1]=c[s+1],e[(i+n*t)*4+0]=c[s+2],e[(i+n*t)*4+3]=c[s+3];return e}function M(o,r,l,a,m,u,x,f,_){const c=l,n=o.width,h=o.height;let s,i=0,t,e;const g=new Uint8Array(n*h*4);for(e=a;e!==u;e+=m)for(t=x;t!==_;t+=f,i++)s=c[i],g[(t+n*e)*4+0]=s,g[(t+n*e)*4+1]=s,g[(t+n*e)*4+2]=s,g[(t+n*e)*4+3]=255;return g}function j(o,r,l,a,m,u,x,f,_){const c=l,n=o.width,h=o.height;let s=0,i,t;const e=new Uint8Array(n*h*4);for(t=a;t!==u;t+=m)for(i=x;i!==_;i+=f,s+=2)e[(i+n*t)*4+0]=c[s+0],e[(i+n*t)*4+1]=c[s+0],e[(i+n*t)*4+2]=c[s+0],e[(i+n*t)*4+3]=c[s+1];return e}const q={GetTGAHeader:T,UploadContent:S,_getImageData8bits:X,_getImageData16bits:C,_getImageData24bits:F,_getImageData32bits:K,_getImageDataGrey8bits:M,_getImageDataGrey16bits:j};export{T as G,S as U};
